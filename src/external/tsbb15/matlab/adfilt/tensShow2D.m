function tensShow2D(C,imfig,tensfig,flag)
%function tensShow2D(C,imfig,tensfig,flag)
% 
% Command to visualize tensors corresponding to
% the the points in figure IMFIG that you left-click.
% The tensor is vizualized in figure TENSFIG.
% C should be a tensor volume generated by tensOrient2D,
% tensMap2D or similar.
% A right-click in figure IMFIG ends the routine.
%
% If FLAG is zero the tensor will be visualized as an
% ellipse oriented along the dominant eigenvector, and
% with minor and major axis sizes according to the eigenvalues
% If FLAG is non zero the tensor will be visualized as a circle
% with the smallest eigenvalue as radius, and an ellipse with
% the biggest eigenvalue as major radius, and the smallest
% divided by ten as the minor radius.
% 
%
% See also tensOrient2D tensLP2D tensMap2D 
%
%By Per-Erik Forssen, 1998

%In order to make the adaptive filtering exercise run
%smoother on 8bit palette systems, all images should
%have the same palette:
colormap([1:255]'/255*[1 1 1]);

button=0;

figure(imfig)
[x y button] = ginput(1); % read one mouse click.
while(button~=3)
    x=round(x);
    y=round(y);
    t = reshape(C(y,x,:),[3 1]);
    [eigval,eigvec] = tens2eig(t);
    figure(tensfig)
    tensorshape2D(eigval,eigvec,flag);
    axis ij;
    s=[sprintf('Tensor at [%d,%d] ',x,y) '\lambda_1=' ...
       sprintf('%g ,',eigval(1)) '\lambda_2=' ...
       sprintf('%g',eigval(2))];
    title(s)
    figure(imfig)
    [x y button] = ginput(1); % read one mouse click.    
end
disp('Done.'); 
